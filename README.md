Here is the main code for the SGM algorithm
